#include <iostream>
#include <queue>
using namespace std;

class node{
    public: 
        int data;
        node* left;
        node* right;

    node(int val){
        data = val;
        right = left = NULL;
    }
};

static int index = -1;
    node* buildTree(int* preOrder){
        index++;
        if(preOrder[index] == -1){
            return NULL;
        }

        node* root = new node(preOrder[index]);
        root->left = buildTree(preOrder);
        root->right = buildTree(preOrder);
        return root;
    }

    //-----------------------------//
    void preOrder(node* root){
        if(root == NULL){
            return;
        }

        cout << root->data << " ";
        preOrder(root->left);
        preOrder(root->right);
    }

    void inOrder(node* root){
        if(root == NULL){
            return;
        }

        inOrder(root->left);
        cout << root->data << " ";
        inOrder(root->right);
    }

    void postOrder(node* root){
        if(root == NULL){
            return;
        }

        postOrder(root->left);
        postOrder(root->right);
        cout << root->data << " ";
    }

    void levelOrder(node* root){
            queue <node*> q;
            q.push(root);

            while(q.size() > 0){
                node* curr = q.front();
                q.pop();
                cout << curr->data << " ";

                if(curr->left != NULL){
                    q.push(curr->left);
                }
                if(curr->right != NULL){
                    q.push(curr->right);
                }
            }
            cout << endl;
    }

    //LevelWiseOrder?
    //----------------------------//

    int calcHeight(node* root){
        if(root == NULL){
            return 0;
        }

        int leftHeight = calcHeight(root->left);
        int rightHeight = calcHeight(root->right);

        return max(leftHeight,rightHeight) + 1;
    }

    int calcCount(node* root){
        if(root == NULL){
            return 0;
        }

        int leftCount = calcCount(root->left);
        int rightCount = calcCount(root->right);

        return leftCount + rightCount + 1;
    }

    int calcSum(node* root){
        if(root == NULL){
            return 0;
        }

        int leftSum = calcSum(root->left);
        int rightSum = calcSum(root->right);

        return leftSum + rightSum + root->data;
    }
    //----------------------------//

    node* insertBST(node* root, int val){
        if(root == NULL){
            return new node(val);
        }

        if(val < root->data){
            root->left = insertBST(root->left, val);
        }
        else if(val > root->data){
            root->right = insertBST(root->right, val);
        }
        return root;
    }

    node* getInOrderSuccesor(node* root){
        if(root->left != NULL && root->right == NULL){
            root = root->left;
        }

        return root;
    }

    Node * deleteNode(Node * root, int key){
	
	if (root==NULL){
		return NULL;
	}
	
	if (key< root->data){
		root->left = deleteNode(root->left,key);
	}
	else if (key > root->data){
		root->right = deleteNode(root->right,key);
	}
	else{ // root->data = key
		 // O children 
		if (root->left==NULL && root->right ==NULL){
			delete root;
			return NULL;
		}
		// 1 children  (have right child)
		else if (root->left ==NULL){
			Node * temp = root->right;
			delete root;
			return temp;
		}
		// 1 children  (have left child)
		else if (root->right == NULL){
			Node * temp = root->left;
			delete root;
			return temp;
		}
		else {  // 2 children
				// 3 steps:
						//1. find InOrder Successor (MIN VALUE TO ROOT->RIGHT)
						//2. Root-data = IS->data;
						//3. delete IS;
				
				Node * InorderSuccessor = getInorderSuccessor(root->right);
				root->data = InorderSuccessor->data;
				root ->right = deleteNode(root->right,InorderSuccessor->data );
			
		}
		
		
	}
	return root;
}


    //----------------------------//
    
int main(){

    int arr[]= {1,2,-1,-1,3,4,-1,-1,5,-1,-1};
    node* temp = buildTree(arr);

    levelOrder(temp);
    cout << "Height: " << calcHeight(temp) << endl;
    cout << "Count of Nodes: " << calcCount(temp) << endl;
    cout << "Sum of Nodes: " << calcSum(temp) << endl;

    node* temp2 = NULL;
    temp2 = insertBST(temp2, 50);
    temp2 = insertBST(temp2, 10);
    temp2 = insertBST(temp2, 20);
    temp2 = insertBST(temp2, 60);
    temp2 = insertBST(temp2, 70);
    temp2 = insertBST(temp2,15);
    preOrder(temp2);

return 0;
}
